@use "uswds-core" as *;
@use "variables" as *;
@use "mixins" as *;

.usa-nav {
  @include u-width('full');

  //desktop
  @include at-media('tablet-lg') {
    .usa-search {
      margin-left: unset;
    }

    &__primary {
      left: 0%;
      @include u-margin-x(auto);

      button[aria-expanded=true] span::after {
        background-color: #FFF;
      }

      a {
        @include u-padding(0);
      }

      button[aria-expanded=false]:hover span::after {
        background-color: #fff;
      }

      >.usa-nav__primary-item {

        >a,
        >button>span {
          font-weight: 700 !important;
        }

        >a {
          padding: 23px 16px;
          font-size: 16px;
          line-height: 155%;
          color: $base-dark;
          @include u-text('normal');

          &:hover {
            color: #FFF;
          }
        }

        &:has(.is-active)::after {
          content: "";
          background-color: $ac-warm;
          display: block;
          position: relative;
          @include u-radius(0);
          @include u-height(0.5);
          @include u-margin-top(-2px);

          @include at-media-max('tablet-lg') {
            display: none;
          }
        }

        &:has(.usa-current[aria-expanded=true])::after {
          display: none;
        }

        >.usa-current::after {
          display: none;
        }

        .usa-nav__submenu {
          width: fit-content;

          .usa-nav__submenu-list {
            @include u-padding(2);

            .usa-nav__submenu-item {

              a,
              span {
                @include u-width('full');
                @include u-text('no-wrap');
                @include u-padding-x(0);
                @include u-margin(0);
                color: #FFF;
              }

              a {
                @include u-margin-bottom(2)
              }

              span {
                margin-bottom: 12px;
              }

              &:nth-of-type(2)>span {
                @include u-margin-top(2);
              }

              &:last-of-type>span {
                @include u-margin-bottom(0);
              }
            }
          }
        }
      }

      &.usa-accordion {
        @include u-margin-top(0);
      }

      @include at-media-max('tablet-lg') {
        .li-divider {
          @include u-height('2px');
          width: 83%;
          display: block;
          background-color: $bg-light-medium;
          @include u-margin-x('auto');
        }
      }
    }

    &__primary-item {
      @include u-border-bottom(1px);
      border: $bg-light-medium;

      &:hover {
        color: $base-dark;
        background-color: $base-dark;
      }

      button {
        font-size: 16px;
        line-height: 155%;
        font-weight: 700;
        color: $base-dark;
        @include u-text('normal');

        &[aria-expanded=true] {
          color: #FFF;
          background-color: $base-dark
        }

        &:hover {
          color: #FFF;
        }
      }
    }

    &__submenu {
      color: $base-dark;
      background-color: $base-dark;
      @include u-padding(0);

      .usa-nav__submenu-item {

        a,
        span {
          @include u-font-size('body', 'sm');
          @include u-padding-x(2);
          @include u-border(0);
          @include u-display('block');
          color: $base-dark;
          text-decoration: none;
        }

        span {
          opacity: 0.6;
        }
      }
    }

    &__secondary {
      bottom: 5.5rem;
    }
  }

  //mobile
  @include at-media-max('tablet-lg') {
    padding: 0;

    .usa-search {
      width: unset;
    }

    &.is-visible {
      @include u-position('relative');
    }

    &__close {
      @include u-display('none');
      @include u-margin-right(0);
      @include u-padding-left(0);
      color: $base-dark;
      margin-left: calc(100% - 90px);
      width: 67px;
      background-image: url('../../../votegov/img/svg/close.svg');
      background-position: 100% 50%;
      background-repeat: no-repeat;
      overflow: visible;
      height: unset;
      text-transform: unset;
      text-decoration: none;
      font-size: 17px;
      font-weight: 500;
      padding-right: 23px;
      margin: 21px 24px;

      &[aria-hidden="true"] {
        display: block;
      }
    }

    &__primary {
      @include u-margin(0);

      .usa-nav__primary-item {

        >a {
          font-family: $theme-font-type-serif;
          color: $base-dark;
          font-size: 18px;
          font-weight: 700;
          line-height: 155%;
        }

        >button>span {
          font-family: $theme-font-type-serif;
          color: $base-dark;
          font-size: 18px;
          font-weight: 700;
          line-height: 155%;
          margin-left: 8px;
        }

        a:not(.usa-button):not(.usa-current) {
          font-family: $theme-font-type-serif;
          color: $base-dark;
          padding: 16px 24px 18.5px;
        }
      }

      button:hover {
        background-color: $bg-light-cool;
      }

      button[aria-expanded=true] span::after,
      button[aria-expanded=false] span::after {
        right: 41.2px;
      }

      .usa-current::after {
        display: none;
      }
    }

    .li-divider {
      @include u-height('1px');
      width: -webkit-calc(100% - 48px);
      width: -moz-calc(100% - 48px);
      width: calc(100% - 48px);
      display: block;
      background-color: $bg-light-medium;
      @include u-margin-x('auto')
    }


    &__primary-item {
      @include u-border(0);

      button {
        @include u-border(0);
        padding: 16px 24px 18.5px;
      }
    }

    &__submenu {
      padding-right: 23px;
      padding-left: 40px;
    }

    &__submenu-item {
      .usa-nav__primary & {

        >span,
        >a:not(.usa-button):not(.usa-current) {
          @include u-display('block');
          font-family: 'Roboto';
          color: $base-dark;
          font-size: 16px;
          font-style: normal;
          font-weight: 400;
          line-height: 155%;
          padding: 16.5px 24px 16.5px 0;
        }

        >span {
          opacity: 0.6;
        }
      }
    }
  }
}
